{"version":3,"file":"address.js","sources":["pages/address/address.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRkcmVzcy9hZGRyZXNzLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"address-manage\">\n      <!-- Address List -->\n      <view v-if=\"!isEditing\" class=\"address-list\">\n        <!-- Mock Map -->\n        <view class=\"map-placeholder\">\n          <text class=\"icon\">üìç</text>\n          <text class=\"text\">ÂΩìÂâçÂÆö‰Ωç: Ê∑±Âú≥Â∏ÇÂçóÂ±±Âå∫ÁßëÊäÄÂõ≠...</text>\n        </view>\n\n        <view v-for=\"addr in addresses\" :key=\"addr.id\" class=\"address-item\" @click=\"selectAddress(addr)\">\n          <view class=\"info\">\n            <view class=\"location\">{{ addr.position }} {{ addr.detail }}</view>\n            <view class=\"contact\">\n                {{ addr.name }} \n                <text class=\"gender\">{{ addr.gender === 0 ? 'ÂÖàÁîü' : 'Â•≥Â£´' }}</text>\n                {{ addr.phone }}\n            </view>\n          </view>\n          <view class=\"actions\">\n            <text v-if=\"addr.tag\" class=\"tag\">{{ addr.tag }}</text>\n            <view class=\"edit-btn\" @click.stop=\"editAddress(addr)\">\n                <text class=\"edit-icon\">‚úé</text>\n            </view>\n            <view class=\"delete-btn\" @click.stop=\"deleteAddress(addr)\">\n                <text class=\"delete-icon\">üóë</text>\n            </view>\n          </view>\n        </view>\n        \n        <view class=\"add-btn\" @click=\"addAddress\">\n          <text>+ Êñ∞Â¢ûÂú∞ÂùÄ</text>\n        </view>\n      </view>\n\n      <!-- Edit Form -->\n      <view v-else class=\"edit-form\">\n        <view class=\"form-group\">\n            <view class=\"form-item\">\n                <text class=\"label\">ËÅîÁ≥ª‰∫∫</text>\n                <input v-model=\"editForm.name\" placeholder=\"ËØ∑Â°´ÂÜôÊî∂Ë¥ß‰∫∫ÂßìÂêç\" class=\"input\"/>\n            </view>\n            <view class=\"form-item\">\n                <text class=\"label\"></text>\n                <view class=\"tags-row\">\n                    <view class=\"radio-tag\" :class=\"{active: editForm.gender === 0}\" @click=\"editForm.gender = 0\">ÂÖàÁîü</view>\n                    <view class=\"radio-tag\" :class=\"{active: editForm.gender === 1}\" @click=\"editForm.gender = 1\">Â•≥Â£´</view>\n                </view>\n            </view>\n            <view class=\"form-item\">\n                <text class=\"label\">ÊâãÊú∫Âè∑</text>\n                <input v-model=\"editForm.phone\" placeholder=\"ËØ∑Â°´ÂÜôÊî∂Ë¥ß‰∫∫ÊâãÊú∫Âè∑\" class=\"input\" type=\"number\" maxlength=\"11\"/>\n            </view>\n            <view class=\"form-item\">\n                <text class=\"label\">Âú∞ÂùÄ</text>\n                <input v-model=\"editForm.position\" placeholder=\"ÁÇπÂáªÈÄâÊã©Êî∂Ë¥ßÂú∞ÂùÄ\" class=\"input\"/>\n                <text class=\"arrow\">></text>\n            </view>\n            <view class=\"form-item\">\n                <text class=\"label\">Èó®ÁâåÂè∑</text>\n                <input v-model=\"editForm.detail\" placeholder=\"‰æãÔºöAÂ∫ß302\" class=\"input\"/>\n            </view>\n            <view class=\"form-item\">\n                <text class=\"label\">Ê†áÁ≠æ</text>\n                <view class=\"tags-row\">\n                    <view v-for=\"tag in ['ÂÆ∂', 'ÂÖ¨Âè∏', 'Â≠¶Ê†°']\" :key=\"tag\" \n                          class=\"radio-tag\" \n                          :class=\"{active: editForm.tag === tag}\" \n                          @click=\"editForm.tag = tag\">\n                        {{ tag }}\n                    </view>\n                </view>\n            </view>\n        </view>\n\n        <view class=\"action-bar\">\n             <button class=\"btn cancel\" @click=\"cancelEdit\">ÂèñÊ∂à</button>\n             <button class=\"btn save\" @click=\"handleSave\">‰øùÂ≠ò</button>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue';\nimport { useUserStore } from '@/store/user';\nimport { globalApi } from '@/api/globalApi';\n\n// Get mode from page options (manage or select)\nconst mode = ref('manage');\n\nconst userStore = useUserStore();\nconst addresses = ref([]);\nconst isEditing = ref(false);\nconst editForm = reactive({\n    userId: userStore.userInfo.id,\n    gender: 0,\n    phone: '',\n    position: '',\n    detail: '',\n    tag: ''\n});\n\nonMounted(() => {\n    // Get mode from query params (not directly accessible in setup, but we default to manage)\n    // If opened from menu via navigateTo, we can't easily pass callback.\n    // Usually use event channel or global store/event bus.\n    // For now assume manage unless we find a way to detect select mode or just use manage always.\n    // If select mode, clicking item should return.\n    \n    // We can check pages stack\n    const pages = getCurrentPages();\n    if (pages.length > 0) {\n        const options = pages[pages.length - 1].options;\n        if (options && options.mode) {\n            mode.value = options.mode;\n        }\n    }\n    \n    loadAddresses();\n});\n\nconst loadAddresses = async () => {\n  if (!userStore.isLoggedIn) return;\n  \n  globalApi['locations'].get(null, { userId: userStore.userInfo.id }, (res) => {\n    addresses.value = res;\n  }, (err) => {\n    uni.showToast({ title: err.msg || 'Ëé∑ÂèñÂú∞ÂùÄÂ§±Ë¥•', icon: 'none' });\n  });\n};\n\nconst cancelEdit = () => {\n    isEditing.value = false;\n};\n\nconst addAddress = () => {\n    Object.assign(editForm, { userId: userStore.userInfo.id, name: '', gender: 0, phone: '', position: '', detail: '', tag: '' });\n    isEditing.value = true;\n};\n\nconst editAddress = (addr) => {\n    Object.assign(editForm, addr);\n    isEditing.value = true;\n};\n\nconst deleteAddress = (addr) => {\n    uni.showModal({\n        title: 'ÊèêÁ§∫',\n        content: 'Á°ÆÂÆöË¶ÅÂà†Èô§ËØ•Âú∞ÂùÄÂêóÔºü',\n        success: async (res) => {\n            if (res.confirm) {\n                uni.showLoading({ title: 'Âà†Èô§‰∏≠' });\n                globalApi['locations'].delete({pk1: addr.id}, null, () => {\n                    uni.hideLoading();\n                    uni.showToast({ title: 'Âà†Èô§ÊàêÂäü' });\n                    loadAddresses();\n                }, (err) => {\n                    uni.hideLoading();\n                    uni.showToast({ title: err.msg || 'Âà†Èô§Â§±Ë¥•', icon: 'none' });\n                });\n            }\n        }\n    });\n};\n\nconst selectAddress = (addr) => {\n    if (mode.value === 'select') {\n        // Return selected address\n        const eventChannel = getCurrentPages()[getCurrentPages().length - 1].getOpenerEventChannel();\n        if (eventChannel) {\n            eventChannel.emit('selectAddress', addr);\n        }\n        uni.navigateBack();\n    }\n};\n\nconst handleSave = async () => {\n    if (!editForm.name || !editForm.phone || !editForm.position || !editForm.detail) {\n        uni.showToast({ title: 'ËØ∑Â°´ÂÜôÂÆåÊï¥‰ø°ÊÅØ', icon: 'none' });\n        return;\n    }\n    \n    uni.showLoading({ title: '‰øùÂ≠ò‰∏≠' });\n    globalApi['locations'].add(null, editForm, (res) => {\n        console.log(res);\n        uni.hideLoading();\n        \n        loadAddresses();\n        isEditing.value = false;\n        uni.showToast({ title: '‰øùÂ≠òÊàêÂäü' });\n    }, (err) => {\n        uni.hideLoading();\n        uni.showToast({ title: err.msg || '‰øùÂ≠òÂ§±Ë¥•', icon: 'none' });\n    });\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  min-height: 100vh;\n  background-color: #f8f8f8;\n  padding: 30rpx;\n  box-sizing: border-box;\n}\n\n.address-list {\n  padding-bottom: 40rpx;\n}\n\n.map-placeholder {\n  height: 200rpx;\n  background: #e6f7ff;\n  border: 2px dashed #91d5ff;\n  border-radius: 16rpx;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 30rpx;\n  color: #1890ff;\n  \n  .icon { font-size: 48rpx; margin-bottom: 10rpx; }\n  .text { font-size: 24rpx; }\n}\n\n.address-item {\n  background: #fff;\n  border-radius: 16rpx;\n  padding: 24rpx;\n  margin-bottom: 20rpx;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  \n  .location { font-weight: bold; font-size: 30rpx; color: #333; margin-bottom: 8rpx; }\n  .contact { \n      font-size: 24rpx; \n      color: #999; \n      .gender { margin: 0 10rpx; }\n  }\n  \n  .actions {\n    display: flex;\n    align-items: center;\n    gap: 16rpx;\n    \n    .tag {\n      background: #e6f7ff;\n      color: #1890ff;\n      font-size: 20rpx;\n      padding: 4rpx 12rpx;\n      border-radius: 8rpx;\n    }\n    .edit-btn, .delete-btn {\n        padding: 10rpx;\n    }\n    .edit-icon, .delete-icon { color: #999; font-size: 28rpx; }\n    .delete-icon { color: #ff4d4f; }\n  }\n}\n\n.add-btn {\n  border: 2px dashed #ddd;\n  padding: 30rpx;\n  border-radius: 16rpx;\n  display: flex;\n  justify-content: center;\n  color: #999;\n  font-weight: bold;\n  background: #fff;\n}\n\n/* Edit Form Styles */\n.form-group {\n    background: #fff;\n    border-radius: 16rpx;\n    padding: 0 24rpx;\n    margin-bottom: 40rpx;\n}\n\n.form-item {\n    display: flex;\n    align-items: center;\n    padding: 30rpx 0;\n    border-bottom: 1px solid #f5f5f5;\n    \n    &:last-child { border-bottom: none; }\n    \n    .label {\n        width: 120rpx;\n        font-size: 28rpx;\n        color: #333;\n        font-weight: bold;\n    }\n    \n    .input {\n        flex: 1;\n        font-size: 28rpx;\n        color: #333;\n    }\n    \n    .arrow { color: #ccc; }\n}\n\n.tags-row {\n    display: flex;\n    gap: 20rpx;\n    \n    .radio-tag {\n        border: 1px solid #ddd;\n        padding: 8rpx 30rpx;\n        border-radius: 8rpx;\n        font-size: 24rpx;\n        color: #666;\n        \n        &.active {\n            background: #fff5e6;\n            border-color: #ff6600;\n            color: #ff6600;\n        }\n    }\n}\n\n.action-bar {\n    display: flex;\n    justify-content: space-between;\n    gap: 30rpx;\n    \n    .btn {\n        flex: 1;\n        height: 88rpx;\n        line-height: 88rpx;\n        text-align: center;\n        border-radius: 44rpx;\n        font-size: 32rpx;\n        font-weight: bold;\n        \n        &.cancel {\n            background: #fff;\n            color: #666;\n            border: 1px solid #ddd;\n        }\n        \n        &.save {\n            background: #ff6600;\n            color: #fff;\n            border: none;\n        }\n    }\n}\n</style>","import MiniProgramPage from 'E:/vue/Â•∂Ëå∂Â∞èÁ®ãÂ∫è/pages/address/address.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","useUserStore","reactive","onMounted","globalApi","uni"],"mappings":"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"}