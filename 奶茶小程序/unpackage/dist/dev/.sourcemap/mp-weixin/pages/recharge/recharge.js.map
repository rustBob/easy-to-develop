{"version":3,"file":"recharge.js","sources":["pages/recharge/recharge.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmVjaGFyZ2UvcmVjaGFyZ2UudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"balance-card\">\n        <text class=\"label\">当前余额</text>\n        <text class=\"amount\">¥{{ userStore.userInfo.balance || '0.00' }}</text>\n    </view>\n    \n    <view class=\"recharge-section\">\n        <text class=\"section-title\">选择充值金额</text>\n        <view class=\"grid\">\n            <view \n                v-for=\"item in rechargeOptions\" \n                :key=\"item.amount\"\n                class=\"option-item\"\n                :class=\"{ active: selectedAmount === item.amount }\"\n                @click=\"selectAmount(item.amount)\"\n            >\n                <text class=\"price\">¥{{ item.amount }}</text>\n                <text class=\"bonus\" v-if=\"item.bonus > 0\">送{{ item.bonus }}元</text>\n            </view>\n        </view>\n        \n        <view class=\"custom-amount\">\n            <text>其他金额：</text>\n            <input \n                type=\"number\" \n                v-model.number=\"customAmount\" \n                placeholder=\"请输入金额\" \n                @input=\"selectedAmount = null\"\n            />\n        </view>\n    </view>\n    \n    <button class=\"pay-btn\" @click=\"handleRecharge\">立即充值</button>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { useUserStore } from '@/store/user';\nimport { globalApi } from '@/api/globalApi';\n\nconst userStore = useUserStore();\nconst selectedAmount = ref(null);\nconst customAmount = ref(null);\n\nconst rechargeOptions = [\n    { amount: 50, bonus: 0 },\n    { amount: 100, bonus: 5 },\n    { amount: 200, bonus: 15 },\n    { amount: 500, bonus: 50 },\n];\n\nconst selectAmount = (amount) => {\n    selectedAmount.value = amount;\n    customAmount.value = null;\n};\n\nconst handleRecharge = async () => {\n    const amount = selectedAmount.value || customAmount.value;\n    if (!amount || amount <= 0) {\n        uni.showToast({ title: '请输入有效金额', icon: 'none' });\n        return;\n    }\n    \n    // Calculate bonus if matching option\n    let bonus = 0;\n    const option = rechargeOptions.find(o => o.amount === amount);\n    if (option) {\n        bonus = option.bonus;\n    }\n    \n    uni.showLoading({ title: '充值中' });\n    try {\n        const newBalance = userStore.userInfo.balance + amount + bonus\n        await globalApi['users'].update(null, {\n            id: userStore.userInfo.id,\n            balance: newBalance\n        }, () => {\n            userStore.updateBalance(newBalance);\n        })\n        \n        uni.hideLoading();\n        uni.showToast({ title: '充值成功' });\n        setTimeout(() => uni.navigateBack(), 1500);\n    } catch (e) {\n        uni.hideLoading();\n        uni.showToast({ title: '充值失败', icon: 'none' });\n    }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n    min-height: 100vh;\n    background: #f8f8f8;\n    padding: 30rpx;\n}\n\n.balance-card {\n    background: linear-gradient(135deg, #ff9a9e 0%, #ff6600 100%);\n    color: #fff;\n    border-radius: 20rpx;\n    padding: 60rpx;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-bottom: 40rpx;\n    box-shadow: 0 8rpx 20rpx rgba(255, 102, 0, 0.2);\n    \n    .label { font-size: 28rpx; opacity: 0.9; margin-bottom: 10rpx; }\n    .amount { font-size: 60rpx; font-weight: bold; }\n}\n\n.recharge-section {\n    background: #fff;\n    border-radius: 20rpx;\n    padding: 30rpx;\n    \n    .section-title {\n        font-size: 32rpx;\n        font-weight: bold;\n        margin-bottom: 30rpx;\n        display: block;\n    }\n    \n    .grid {\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: space-between;\n        \n        .option-item {\n            width: 48%;\n            border: 1px solid #ddd;\n            border-radius: 12rpx;\n            padding: 30rpx 0;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            margin-bottom: 24rpx;\n            \n            &.active {\n                border-color: #ff6600;\n                background: #fff5e6;\n                color: #ff6600;\n            }\n            \n            .price { font-size: 36rpx; font-weight: bold; margin-bottom: 6rpx; }\n            .bonus { font-size: 24rpx; color: #ff6600; }\n        }\n    }\n    \n    .custom-amount {\n        display: flex;\n        align-items: center;\n        margin-top: 20rpx;\n        padding-top: 20rpx;\n        border-top: 1px solid #f5f5f5;\n        \n        input {\n            flex: 1;\n            margin-left: 20rpx;\n            font-size: 30rpx;\n        }\n    }\n}\n\n.pay-btn {\n    margin-top: 60rpx;\n    background: #07c160;\n    color: #fff;\n    border-radius: 50rpx;\n    font-weight: bold;\n}\n</style>\n","import MiniProgramPage from 'E:/vue/奶茶小程序/pages/recharge/recharge.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","ref","uni","globalApi"],"mappings":";;;;;;;AA0CA,UAAM,YAAYA,WAAY,aAAA;AAC9B,UAAM,iBAAiBC,cAAAA,IAAI,IAAI;AAC/B,UAAM,eAAeA,cAAAA,IAAI,IAAI;AAE7B,UAAM,kBAAkB;AAAA,MACpB,EAAE,QAAQ,IAAI,OAAO,EAAG;AAAA,MACxB,EAAE,QAAQ,KAAK,OAAO,EAAG;AAAA,MACzB,EAAE,QAAQ,KAAK,OAAO,GAAI;AAAA,MAC1B,EAAE,QAAQ,KAAK,OAAO,GAAI;AAAA,IAC9B;AAEA,UAAM,eAAe,CAAC,WAAW;AAC7B,qBAAe,QAAQ;AACvB,mBAAa,QAAQ;AAAA,IACzB;AAEA,UAAM,iBAAiB,YAAY;AAC/B,YAAM,SAAS,eAAe,SAAS,aAAa;AACpD,UAAI,CAAC,UAAU,UAAU,GAAG;AACxBC,sBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,OAAM,CAAE;AAChD;AAAA,MACH;AAGD,UAAI,QAAQ;AACZ,YAAM,SAAS,gBAAgB,KAAK,OAAK,EAAE,WAAW,MAAM;AAC5D,UAAI,QAAQ;AACR,gBAAQ,OAAO;AAAA,MAClB;AAEDA,oBAAAA,MAAI,YAAY,EAAE,OAAO,MAAO,CAAA;AAChC,UAAI;AACA,cAAM,aAAa,UAAU,SAAS,UAAU,SAAS;AACzD,cAAMC,8BAAU,OAAO,EAAE,OAAO,MAAM;AAAA,UAClC,IAAI,UAAU,SAAS;AAAA,UACvB,SAAS;AAAA,QACrB,GAAW,MAAM;AACL,oBAAU,cAAc,UAAU;AAAA,QAC9C,CAAS;AAEDD,sBAAG,MAAC,YAAW;AACfA,sBAAAA,MAAI,UAAU,EAAE,OAAO,OAAQ,CAAA;AAC/B,mBAAW,MAAMA,cAAG,MAAC,aAAc,GAAE,IAAI;AAAA,MAC5C,SAAQ,GAAG;AACRA,sBAAG,MAAC,YAAW;AACfA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,OAAM,CAAE;AAAA,MAChD;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;ACxFA,GAAG,WAAW,eAAe;"}