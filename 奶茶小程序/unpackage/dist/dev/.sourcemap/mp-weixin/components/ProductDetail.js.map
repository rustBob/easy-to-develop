{"version":3,"file":"ProductDetail.js","sources":["components/ProductDetail.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovdnVlL-WltuiMtuWwj-eoi-W6jy9jb21wb25lbnRzL1Byb2R1Y3REZXRhaWwudnVl"],"sourcesContent":["<template>\n  <view class=\"modal-mask\" v-if=\"visible\" @click.stop=\"close\">\n    <view class=\"modal-content\" @click.stop>\n      <!-- Top Image -->\n      <view class=\"product-image-container\">\n        <image :src=\"product.image\" mode=\"aspectFill\" class=\"product-image\" />\n        <view class=\"close-btn\" @click=\"close\">\n          <text class=\"icon-close\">×</text>\n        </view>\n      </view>\n\n      <!-- Content -->\n      <scroll-view scroll-y class=\"product-info\">\n        <text class=\"product-name\">{{ product.name }}</text>\n        <text class=\"product-desc\">{{ product.description }}</text>\n\n        <!-- Specs -->\n        <view class=\"specs-container\">\n          <view v-for=\"(spec, idx) in product.specs\" :key=\"idx\" class=\"spec-group\">\n            <text class=\"spec-title\">{{ spec.name }}</text>\n            <view class=\"spec-options\">\n              <view \n                v-for=\"opt in spec.option\" \n                :key=\"opt\"\n                class=\"spec-option\"\n                :class=\"{ active: currentSpecs[spec.name] === opt }\"\n                @click=\"selectSpec(spec.name, opt)\"\n              >\n                <text>{{ opt }}</text>\n              </view>\n            </view>\n          </view>\n        </view>\n      </scroll-view>\n\n      <!-- Footer Action -->\n      <view class=\"action-bar\">\n        <view class=\"price-info\">\n          <text class=\"price\">¥{{ calculatePrice }}</text>\n          <text class=\"selected-specs\">{{ selectedSpecString }}</text>\n        </view>\n        <view class=\"action-right\">\n          <view class=\"stepper\">\n            <view class=\"step-btn\" @click=\"changeQty(-1)\">-</view>\n            <text class=\"qty\">{{ qty }}</text>\n            <view class=\"step-btn\" @click=\"changeQty(1)\">+</view>\n          </view>\n          <view class=\"add-btn\" @click=\"handleAddToCart\">加入购物袋</view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, computed, watch, reactive } from 'vue';\n\nconst props = defineProps({\n  visible: Boolean,\n  product: Object\n});\n\nconst emit = defineEmits(['update:visible', 'add-to-cart']);\n\nconst qty = ref(1);\nconst currentSpecs = reactive({});\n\n// Watch product change to reset specs\nwatch(() => props.product, (newVal) => {\n  if (newVal && newVal.specs) {\n    qty.value = 1;\n    newVal.specs.forEach(s => {\n      s.option = JSON.parse(s.option);\n      currentSpecs[s.name] = s.option[0];\n    });\n  }\n}, { immediate: true });\n\nconst selectedSpecString = computed(() => Object.values(currentSpecs).join('/'));\nconst calculatePrice = computed(() => props.product ? (props.product.price * qty.value).toFixed(2) : 0);\n\nconst close = () => {\n  emit('update:visible', false);\n};\n\nconst selectSpec = (name, opt) => {\n  currentSpecs[name] = opt;\n};\n\nconst changeQty = (delta) => {\n  const newVal = qty.value + delta;\n  if (newVal >= 1) qty.value = newVal;\n};\n\nconst handleAddToCart = () => {\n  emit('add-to-cart', {\n    product: props.product,\n    specs: selectedSpecString.value,\n    qty: qty.value\n  });\n  close();\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.modal-mask {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 1001; // Above CartBar (1000)\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n}\n\n.modal-content {\n  background-color: #fff;\n  border-top-left-radius: 24rpx;\n  border-top-right-radius: 24rpx;\n  overflow: hidden;\n  height: 80vh;\n  display: flex;\n  flex-direction: column;\n}\n\n.product-image-container {\n  position: relative;\n  height: 400rpx;\n  \n  .product-image {\n    width: 100%;\n    height: 100%;\n  }\n  \n  .close-btn {\n    position: absolute;\n    top: 20rpx;\n    left: 20rpx;\n    width: 60rpx;\n    height: 60rpx;\n    background: rgba(0,0,0,0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    \n    .icon-close {\n      color: #fff;\n      font-size: 40rpx;\n      line-height: 1;\n    }\n  }\n}\n\n.product-info {\n  flex: 1;\n  padding: 30rpx;\n  box-sizing: border-box;\n}\n\n.product-name {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: #333;\n  display: block;\n}\n\n.product-desc {\n  font-size: 24rpx;\n  color: #999;\n  margin-top: 10rpx;\n  display: block;\n}\n\n.specs-container {\n  margin-top: 40rpx;\n}\n\n.spec-group {\n  margin-bottom: 30rpx;\n  \n  .spec-title {\n    font-size: 28rpx;\n    font-weight: bold;\n    color: #666;\n    margin-bottom: 20rpx;\n    display: block;\n  }\n  \n  .spec-options {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 20rpx;\n  }\n  \n  .spec-option {\n    padding: 10rpx 30rpx;\n    background: #f5f5f5;\n    border: 1px solid #eee;\n    border-radius: 8rpx;\n    font-size: 26rpx;\n    color: #666;\n    \n    &.active {\n      background: #fff5e6;\n      border-color: #ff6600;\n      color: #ff6600;\n      font-weight: bold;\n    }\n  }\n}\n\n.action-bar {\n  padding: 20rpx 30rpx 40rpx; // Extra padding for safe area\n  background: #fff;\n  border-top: 1px solid #eee;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.price-info {\n  .price {\n    font-size: 40rpx;\n    font-weight: bold;\n    color: #ff6600;\n    display: block;\n  }\n  .selected-specs {\n    font-size: 22rpx;\n    color: #999;\n  }\n}\n\n.action-right {\n  display: flex;\n  align-items: center;\n  gap: 20rpx;\n}\n\n.stepper {\n  display: flex;\n  align-items: center;\n  background: #f5f5f5;\n  border-radius: 8rpx;\n  \n  .step-btn {\n    width: 60rpx;\n    height: 60rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 30rpx;\n    color: #666;\n  }\n  \n  .qty {\n    width: 40rpx;\n    text-align: center;\n    font-weight: bold;\n    font-size: 28rpx;\n  }\n}\n\n.add-btn {\n  background: #ff6600;\n  color: #fff;\n  padding: 16rpx 40rpx;\n  border-radius: 40rpx;\n  font-size: 28rpx;\n  font-weight: bold;\n}\n</style>\n","import Component from 'E:/vue/奶茶小程序/components/ProductDetail.vue'\nwx.createComponent(Component)"],"names":["ref","reactive","watch","computed"],"mappings":";;;;;;;;;;AAyDA,UAAM,QAAQ;AAKd,UAAM,OAAO;AAEb,UAAM,MAAMA,cAAAA,IAAI,CAAC;AACjB,UAAM,eAAeC,cAAAA,SAAS,CAAA,CAAE;AAGhCC,kBAAK,MAAC,MAAM,MAAM,SAAS,CAAC,WAAW;AACrC,UAAI,UAAU,OAAO,OAAO;AAC1B,YAAI,QAAQ;AACZ,eAAO,MAAM,QAAQ,OAAK;AACxB,YAAE,SAAS,KAAK,MAAM,EAAE,MAAM;AAC9B,uBAAa,EAAE,IAAI,IAAI,EAAE,OAAO,CAAC;AAAA,QACvC,CAAK;AAAA,MACF;AAAA,IACH,GAAG,EAAE,WAAW,KAAI,CAAE;AAEtB,UAAM,qBAAqBC,cAAAA,SAAS,MAAM,OAAO,OAAO,YAAY,EAAE,KAAK,GAAG,CAAC;AAC/E,UAAM,iBAAiBA,cAAAA,SAAS,MAAM,MAAM,WAAW,MAAM,QAAQ,QAAQ,IAAI,OAAO,QAAQ,CAAC,IAAI,CAAC;AAEtG,UAAM,QAAQ,MAAM;AAClB,WAAK,kBAAkB,KAAK;AAAA,IAC9B;AAEA,UAAM,aAAa,CAAC,MAAM,QAAQ;AAChC,mBAAa,IAAI,IAAI;AAAA,IACvB;AAEA,UAAM,YAAY,CAAC,UAAU;AAC3B,YAAM,SAAS,IAAI,QAAQ;AAC3B,UAAI,UAAU;AAAG,YAAI,QAAQ;AAAA,IAC/B;AAEA,UAAM,kBAAkB,MAAM;AAC5B,WAAK,eAAe;AAAA,QAClB,SAAS,MAAM;AAAA,QACf,OAAO,mBAAmB;AAAA,QAC1B,KAAK,IAAI;AAAA,MACb,CAAG;AACD;IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpGA,GAAG,gBAAgB,SAAS;"}